import{_ as n,c as t,a as s,a4 as i,j as a,o as l}from"./chunks/framework.BMnk781U.js";const B=JSON.parse('{"title":"查看服务","description":"","frontmatter":{"title":"查看服务"},"headers":[],"relativePath":"DevOps/linux/Linux服务管理.md","filePath":"DevOps/linux/Linux服务管理.md"}'),e={name:"DevOps/linux/Linux服务管理.md"},p=i(`<br><br><blockquote><p>服务的本质就是进程，但是运行在后台的，通常监听某个端口，等待其他程序的请求，所以又称守护进程。可使用 service [服务名] [start | stop | resrart | reload | status]。当然在 centos7 之后使用<code>systemctl</code>命令代替<code>service</code>命令，本文着重介绍<code>systemctl</code>命令。</p></blockquote><h2 id="查看服务" tabindex="-1">查看服务 <a class="header-anchor" href="#查看服务" aria-label="Permalink to &quot;查看服务&quot;">​</a></h2><p>可以使用<code>setup</code>命令查看到所有服务，其中前面有<code>*</code>号的任务则表示该任务会随着 Linux 的启动而启动，没有带<code>*</code>号则需要手动启动。下图是输入<code>setup</code>命令后的界面。</p><p align="center"><img src="https://img2.imgtp.com/2024/05/05/dJNub4Vq.PNG"></p><p align="center"><img src="https://img2.imgtp.com/2024/05/05/jU1Ux9lD.PNG"></p><h3 id="服务的运行级别" tabindex="-1">服务的运行级别 <a class="header-anchor" href="#服务的运行级别" aria-label="Permalink to &quot;服务的运行级别&quot;">​</a></h3><ul><li>运行级别 0:系统停机状态，系统默认运行级别不能设为 0，否则不能正常启动</li><li>运行级别 1:单用户工作状态，root 权限，用于系统维护，禁止远程登陆</li><li>运行级别 2:多用户状态(没有 NFS)，不支持网络</li><li>运行级别 3:完全的多用户状态(有 NFS)，登陆后进入控制台命令行模式 （常用）</li><li>运行级别 4:系统未使用，保留</li><li>运行级别 5:X11 控制台，登陆后进入图形 GUI 模式 （常用）</li><li>运行级别 6:系统正常关闭并重启，默认运行级别不能设为 6，否则不能正常启动</li></ul><h3 id="chkconfig-指令" tabindex="-1">chkconfig 指令 <a class="header-anchor" href="#chkconfig-指令" aria-label="Permalink to &quot;chkconfig 指令&quot;">​</a></h3><p>通过该指令给服务器的各个运行级别设置自启动或关闭状态。相关的指令服务在/etc/init.d 中。这里只是简单介绍，后续的<code>systemctl</code>才是重点。</p><ul><li>chkconfig [--add][--del][--list][系统服务]</li><li>chkconfig [--level &lt;等级代号&gt;][系统服务][on/off/reset]</li></ul><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>--add 增加所指定的系统服务，让 chkconfig 指令得以管理它，并同时在系统启动的叙述文件内增加相关数据。</span></span>
<span class="line"><span>--del 删除所指定的系统服务，不再由 chkconfig 指令管理，并同时在系统启动的叙述文件内删除相关数据。</span></span>
<span class="line"><span>--level&lt;等级代号&gt; 指定读系统服务要在哪一个执行等级中开启或关闭。</span></span></code></pre></div><p>这里举个例子：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chkconfig</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --list</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      //列出</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chkconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 所知道的所有的服务的情况</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chkconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> telnet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   //开启</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Telnet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chkconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> telnet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> off</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  //</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 关闭</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Telnet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 服务</span></span></code></pre></div><h2 id="systemctl" tabindex="-1">systemctl <a class="header-anchor" href="#systemctl" aria-label="Permalink to &quot;systemctl&quot;">​</a></h2><p><code>systemctl</code>相关指令管理的服务在<code>/usr/lib/systemd/system</code>查看。常用的命令如下</p><ol><li>systemctl [start l stop | restart | status] [服务名]</li><li>systemctl 设置服务的自启动状态</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  1.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list-unit-files</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 服务名]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (查看服务开机启动状态,grep可以进行过滤）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  2.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 服务名</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">设置服务开机启动</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  3.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 服务名</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">关闭服务开机启动</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  4.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is-enabled</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 服务名</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">查询某个服务是否是自启动的</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>上述的指令只是临时生效，当重启系统后还是会回归到之前的配置，想要永久生效要使用以下命令：</strong><code>systemctl [enable | disable] [服务名]</code></p><p>这里以防火墙服务为例</p><ol><li>查看防火墙服务状态</li></ol><p align="center"><img src="https://img2.imgtp.com/2024/05/05/ZCKAsTJX.png"></p>`,23),h=a("p",{align:"center"},[a("img",{src:"https://img2.imgtp.com/2024/05/05/WkMo48gr.png"})],-1),k=i(`<p align="center"><img src="https://img2.imgtp.com/2024/05/05/LziSrjmJ.png"></p><h2 id="动态监视进程" tabindex="-1">动态监视进程 <a class="header-anchor" href="#动态监视进程" aria-label="Permalink to &quot;动态监视进程&quot;">​</a></h2><p>与 ps 指令很类似，但是 top 在执行一段时间可以更新正在运行的进程。命令：<code>top [选项]</code></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">选项</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [秒数] ： 指定top命令每隔几秒更新</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ：</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 使top不显示任何闲置或者僵死状态</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ：</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 通过指定监控进程ID来仅仅监控某个进程的状态</span></span></code></pre></div><p align="center"><img src="https://img2.imgtp.com/2024/05/05/KlJIaKx7.png"></p>`,5),d=i(`<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 以CPU使用率排序，默认就是此项</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 以内存的使用率排序</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">N</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 以PID排序</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">q</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 退出top</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [用户名] ： 监视特定用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [PID号] ： 终止指定的进程</span></span></code></pre></div><h2 id="监控网络状态" tabindex="-1">监控网络状态 <a class="header-anchor" href="#监控网络状态" aria-label="Permalink to &quot;监控网络状态&quot;">​</a></h2><p>该命令是一个监控 TCP/IP 网络的非常有用的工具，它可以显示路由表、实际的网络连接以及每一个网络接口设备的状态信息。Netstat 用于显示与 IP、TCP、UDP 和 ICMP 协议相关的统计数据，一般用于检验本机各端口的网络连接情况。</p><p>命令为<code>netstat [选项]</code>。这里介绍常见参数：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">选项：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (all) 显示所有选项，默认不显示LISTEN相关。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (tcp) 仅显示tcp相关选项。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (udp) 仅显示udp相关选项。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 拒绝显示别名，能显示数字的全部转化成数字。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 仅列出有在</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Listen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (监听) 的服务状态。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 显示建立相关链接的程序名</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 显示路由信息，路由表</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 显示扩展信息，例如uid等</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 按各个协议进行统计</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 每隔一个固定时间，执行该netstat命令。</span></span></code></pre></div><p>例如查找关于 sshd 的网络状态：</p><p align="center"><img src="https://img2.imgtp.com/2024/05/05/ZR5SEkKu.png"></p>`,7);function c(r,F,g,o,y,E){return l(),t("div",null,[p,s(" 2. 关闭防火墙服务 "),h,s(" 3. 重启防火墙服务 "),k,s(" 在top后展示的页面中可选择以下选项进行相关操作: "),d])}const u=n(e,[["render",c]]);export{B as __pageData,u as default};
